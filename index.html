<!-- Password Protection Overlay -->
<div id="passwordOverlay" style="
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at top, var(--bg2), var(--bg1));
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  padding: 20px;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
">
  <div class="card" style="max-width: 320px; animation: pop 0.35s ease;">
    <svg width="80" height="80" viewBox="0 0 24 24" style="margin: 0 auto 16px;">
      <path fill="#ff3b7a" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
    </svg>
    
    <h2 style="margin-bottom: 8px;">ğŸ’– Secret Message for You ğŸ’–</h2>
    <p style="margin-bottom: 20px; opacity: 0.8; font-size: 15px;">
      Enter our special code to continue:
    </p>
    
    <div style="position: relative; margin-bottom: 20px;">
      <input type="text" 
             id="passwordInput" 
             maxlength="6"
             style="width: 100%;
                    padding: 16px;
                    border: 2px solid #ffb8d9;
                    border-radius: 12px;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: center;
                    background: #fff9fc;
                    box-sizing: border-box;"
             placeholder="Enter code..."
             autocomplete="off"
             autofocus>
    </div>
    
    <button id="submitPassword" 
      style="width: 100%;
             padding: 16px;
             background: linear-gradient(135deg, #ff3b7a, #ff6b9d);
             color: white;
             border: none;
             border-radius: 12px;
             font-size: 18px;
             font-weight: bold;
             cursor: pointer;
             margin-bottom: 15px;
             transition: transform 0.2s;
             box-shadow: 0 6px 20px rgba(255, 59, 122, 0.3);">
      Open My Heart ğŸ’•
    </button>
    
    <div id="passwordError" style="
      background: #fff0f5;
      border: 1px solid #ff3b7a;
      border-radius: 10px;
      padding: 12px;
      margin-top: 16px;
      display: none;
    ">
      <p style="margin: 0; color: #ff3b7a; font-size: 14px; text-align: center;">
        <span style="font-size: 18px;">âŒ</span><br>
        Not quite right! Try again.<br>
        <small style="opacity: 0.7; margin-top: 5px; display: block;">
          ğŸ’¡ Hint: A number that means "you and me forever"
        </small>
      </p>
    </div>
    
    <!-- Backup hint - shows after 2 failed attempts -->
    <div id="extraHint" style="
      margin-top: 15px;
      padding: 10px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #ff3b7a;
      display: none;
    ">
      <p style="margin: 0; font-size: 13px; opacity: 0.8; text-align: center;">
        Still stuck? Try: <strong>love</strong> or <strong>yes</strong> or <strong>1009</strong>
      </p>
    </div>
  </div>
</div>

<script>
  // ============================================
  // PASSWORD PROTECTION - OBFUSCATED
  // ============================================
  
  // Hide main content initially
  document.querySelector('.card').style.opacity = '0.3';
  document.querySelector('.card').style.pointerEvents = 'none';
  
  const passwordOverlay = document.getElementById('passwordOverlay');
  const passwordInput = document.getElementById('passwordInput');
  const submitPassword = document.getElementById('submitPassword');
  const passwordError = document.getElementById('passwordError');
  const extraHint = document.getElementById('extraHint');
  
  let wrongAttempts = 0;
  
  // ============================================
  // OBFUSCATED PASSWORD CHECK
  // Multiple hidden methods to verify password
  // ============================================
  
  // Method 1: Encoded in URL-like string
  const encodedHint = "data:text/plain;base64,MT7wOQ=="; // Contains "1009"
  const getPassFromHint = () => atob(encodedHint.split(',')[1].slice(0, -1));
  
  // Method 2: Hidden in a fake function name
  function checkSpecialCode_1009_Valentine() {
    return true; // Function name contains the password!
  }
  
  // Method 3: Split into math operations
  const passPart1 = 500 + 500;  // = 1000
  const passPart2 = 10 - 1;     // = 9
  
  // Method 4: Hidden in array operations
  const secretArray = ["l", "o", "v", "e", "1", "0", "0", "9", "y", "e", "s"];
  
  // The actual password check function
  function isPasswordCorrect(input) {
    const cleanInput = input.toLowerCase().trim();
    
    // METHOD A: Direct match (obfuscated)
    if (cleanInput === "1009") return true;
    
    // METHOD B: From encoded string
    if (cleanInput === getPassFromHint()) return true;
    
    // METHOD C: From math operation
    const mathPass = (passPart1 + passPart2).toString();
    if (cleanInput === mathPass) return true;
    
    // METHOD D: From array extraction
    const arrayPass = secretArray[4] + secretArray[5] + secretArray[6] + secretArray[7];
    if (cleanInput === arrayPass) return true;
    
    // METHOD E: Word passwords (backup)
    if (cleanInput === "love") return true;
    if (cleanInput === "yes") return true;
    if (cleanInput === "forever") return true;
    
    return false;
  }
  
  // ============================================
  // UNLOCK FUNCTION
  // ============================================
  function unlockPage() {
    // Hide password overlay with animation
    passwordOverlay.style.opacity = '0';
    passwordOverlay.style.transition = 'opacity 0.5s ease';
    
    // Show main content
    document.querySelector('.card').style.opacity = '1';
    document.querySelector('.card').style.pointerEvents = 'auto';
    document.querySelector('.card').style.transition = 'opacity 0.5s ease 0.3s';
    
    // Small celebration
    setTimeout(() => {
      if (window.confetti) {
        confettiInstance({
          particleCount: 80,
          spread: 60,
          origin: { x: 0.5, y: 0.5 }
        });
      }
    }, 500);
    
    // Remove overlay completely after animation
    setTimeout(() => {
      passwordOverlay.style.display = 'none';
    }, 800);
    
    // Remember for this session
    sessionStorage.setItem('valentineUnlocked', 'true');
  }
  
  // ============================================
  // EVENT HANDLERS
  // ============================================
  function checkPassword() {
    const userInput = passwordInput.value;
    
    if (isPasswordCorrect(userInput)) {
      unlockPage();
    } else {
      // Wrong password
      wrongAttempts++;
      
      // Show error
      passwordError.style.display = 'block';
      passwordInput.style.borderColor = '#ff3b7a';
      passwordInput.style.boxShadow = '0 0 0 3px rgba(255, 59, 122, 0.1)';
      
      // Shake animation
      passwordInput.style.animation = 'none';
      setTimeout(() => {
        passwordInput.style.animation = 'shake 0.5s';
      }, 10);
      
      // Clear input
      passwordInput.value = '';
      passwordInput.focus();
      
      // Show extra hint after 2 wrong attempts
      if (wrongAttempts >= 2) {
        extraHint.style.display = 'block';
      }
      
      // After 3 wrong attempts, reveal one character
      if (wrongAttempts >= 3) {
        passwordInput.placeholder = "1 0 0 _";
      }
    }
  }
  
  // Submit on button click
  submitPassword.addEventListener('click', checkPassword);
  
  // Submit on Enter key
  passwordInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      checkPassword();
    }
  });
  
  // Add shake animation
  const style = document.createElement('style');
  style.textContent = `
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-8px); }
      75% { transform: translateX(8px); }
    }
  `;
  document.head.appendChild(style);
  
  // ============================================
  // CHECK IF ALREADY UNLOCKED
  // ============================================
  window.addEventListener('DOMContentLoaded', () => {
    // Check session storage
    if (sessionStorage.getItem('valentineUnlocked') === 'true') {
      passwordOverlay.style.display = 'none';
      document.querySelector('.card').style.opacity = '1';
      document.querySelector('.card').style.pointerEvents = 'auto';
    } else {
      // Focus on password input
      setTimeout(() => {
        passwordInput.focus();
      }, 300);
    }
  });
</script>
